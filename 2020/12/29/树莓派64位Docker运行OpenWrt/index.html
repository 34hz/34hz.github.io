<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>树莓派64位Docker运行OpenWrt | 34Hz</title><meta name="keywords" content="教程,工具,配置,linux,软路由"><meta name="author" content="34hz"><meta name="copyright" content="34hz"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="场景1众所周知，OpenWrt 是面向嵌入型设备的 Linux 发行版，所以  OpenWrt 系统运行时的资源占用率会很低。而树莓派的硬件性能要比普通路由器要高很多。虽然树莓派在硬件配置上的绝对优势能让 OpenWrt 有更大的施展空间，但相应的，硬件上的优势也带来了资源的浪费（OpenWrt 在树莓派上正常运行时，资源占用率只有不到 1&#x2F;10）。再加上 OpenWrt 的可扩展性不是很强，所以">
<meta property="og:type" content="article">
<meta property="og:title" content="树莓派64位Docker运行OpenWrt">
<meta property="og:url" content="http://www.34hz.top/2020/12/29/%E6%A0%91%E8%8E%93%E6%B4%BE64%E4%BD%8DDocker%E8%BF%90%E8%A1%8COpenWrt/index.html">
<meta property="og:site_name" content="34Hz">
<meta property="og:description" content="场景1众所周知，OpenWrt 是面向嵌入型设备的 Linux 发行版，所以  OpenWrt 系统运行时的资源占用率会很低。而树莓派的硬件性能要比普通路由器要高很多。虽然树莓派在硬件配置上的绝对优势能让 OpenWrt 有更大的施展空间，但相应的，硬件上的优势也带来了资源的浪费（OpenWrt 在树莓派上正常运行时，资源占用率只有不到 1&#x2F;10）。再加上 OpenWrt 的可扩展性不是很强，所以">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/0076tTSdgy1gm55f69axxj30d603n3yi.jpg">
<meta property="article:published_time" content="2020-12-29T03:20:46.000Z">
<meta property="article:modified_time" content="2020-12-29T15:36:31.089Z">
<meta property="article:author" content="34hz">
<meta property="article:tag" content="教程">
<meta property="article:tag" content="工具">
<meta property="article:tag" content="配置">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="软路由">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva3.sinaimg.cn/large/0076tTSdgy1gm55f69axxj30d603n3yi.jpg"><link rel="shortcut icon" href="/img/ico.png"><link rel="canonical" href="http://www.34hz.top/2020/12/29/%E6%A0%91%E8%8E%93%E6%B4%BE64%E4%BD%8DDocker%E8%BF%90%E8%A1%8COpenWrt/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":1,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-12-29 23:36:31'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}const fontSizeVal = saveToLocal.get('global-font-size')
if (fontSizeVal !== undefined) {
  document.documentElement.style.setProperty('--global-font-size', fontSizeVal + 'px')
}})()</script><link rel="stylesheet" href="/css/custom.css"  media="defer" onload="this.media='all'"><meta name="generator" content="Hexo 5.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/ico.png'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.google.com"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://tva1.sinaimg.cn/large/0076tTSdgy1gm55dvdv8sj30nx0b7ac8.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">34Hz</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.google.com"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">树莓派64位Docker运行OpenWrt</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-12-29T03:20:46.000Z" title="发表于 2020-12-29 11:20:46">2020-12-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-12-29T15:36:31.089Z" title="更新于 2020-12-29 23:36:31">2020-12-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/">教程</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/%E5%B7%A5%E5%85%B7/">工具</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/%E5%B7%A5%E5%85%B7/Linux/">Linux</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/%E5%B7%A5%E5%85%B7/Linux/PI/">PI</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%99%E7%A8%8B/%E5%B7%A5%E5%85%B7/Linux/PI/%E8%BD%AF%E8%B7%AF%E7%94%B1/">软路由</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>12分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="场景1"><a href="#场景1" class="headerlink" title="场景1"></a>场景1</h3><p>众所周知，OpenWrt 是面向嵌入型设备的 Linux 发行版，所以  OpenWrt 系统运行时的资源占用率会很低。而树莓派的硬件性能要比普通路由器要高很多。虽然树莓派在硬件配置上的绝对优势能让 OpenWrt 有更大的施展空间，但相应的，硬件上的优势也带来了资源的浪费（OpenWrt 在树莓派上正常运行时，资源占用率只有不到 1/10）。再加上 OpenWrt 的可扩展性不是很强，所以很多能在 Raspbian/Debian 上能做的事情在 OpenWrt 上往往无法实现。</p>
<p>所以，可不可以让  OpenWrt 与我们常用的系统共存呢？这样，我们可以享受到 OpenWrt 的功能，又可以让在我们常用的系统中完成一般性的 Linux 工作。</p>
<p>通过 Docker，完全可以。</p>
<h3 id="场景2"><a href="#场景2" class="headerlink" title="场景2"></a>场景2</h3><p> OpenWrt 的功能固然强大，但是树莓派的板载网卡无线吞吐能力实在是无力吐槽，能否将现有路由器与树莓派结合使用，同时发挥现有路由器的信号优势与 OpenWrt  的软件优势呢？</p>
<p>通过旁路网关，完全可以。</p>
<h3 id="旁路网关"><a href="#旁路网关" class="headerlink" title="旁路网关"></a>旁路网关</h3><p>那么，什么是旁路网关呢？</p>
<p>普通的路由器往往集无线信号转发、网关、DNS 服务器等角色为一身，其中的“网关”角色负责路由器内部数据的处理。但因为一般家用的路由器硬件性能很有限，在运行一些比较吃资源的应用（如酸酸乳、去广告等）时，几乎会占满所有硬件资源，导致路由器网络/系统不稳定等诸多问题。既然路由器的硬件性能有限，那可不可以把网关的重任交给硬件性能更好的设备去做，让路由器安安心心地做好它的老本行 – 无线转发呢？</p>
<p>完全可以。</p>
<p>所谓的旁路网关，就是在路由器之外的其他硬件设备上搭建一个网关环境，把路由器肩负的网关重任交给其他更适合的设备来做，同时，旁路网关处理完的结果会返回给路由器，由路由器继续进行无线转发。</p>
<p>这样，每个角色各司其职，路由器肩上的任务轻了，即使是油管 4K 也能轻松跑满网速了，而旁路由（树莓派）也结束了它吃灰的命运。由此资源的充分利用，一举两得。</p>
<p>在接下来的文章中，我们将在 Docker 容器中运行 OpenWrt，并通过设置，让 Docker 容器中的 OpenWrt 网关接管路由器自身的网关，减轻路由器的负担，同时，由于网关被 OpenWrt 接管，所以 OpenWrt 中的大部分应用都是可用的，比如酸酸乳，V2ray，去广告等。做个不恰当的比喻， OpenWrt 网关接管路由器自身的网关后，你可以理解为路由器是 OpenWrt 的一块外置网卡。</p>
<h2 id="重要说明"><a href="#重要说明" class="headerlink" title="重要说明"></a>重要说明</h2><p>1.<strong>此教程中提到的 Docker 镜像只适用于树莓派 2B/3B/3B+/4B，在其他设备上理论上不能正常使用</strong>。但文中所述内容对其他设备应该有参考意义。</p>
<p>2.在 Docker 中运行  OpenWrt ，树莓派将工作在旁路网关模式下，在这种工作模式下，树莓派的板载无线网卡不会工作（同时在  OpenWrt  的控制面板中也找不到有关 WIFI 的设置）。所以，需要将树莓派与路由器通过网线连接来使用。</p>
<h2 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h2><p>既然需要在 Docker 中运行  OpenWrt ，那么首先需要在树莓派的现有系统上安装 Docker，在不同发行版上安装 Docker 的教程有很多，大家可以自行在搜索引擎中搜索相关内容以完成 Docker 的安装。</p>
<p>如果你的设备是 3B/3B+/4B，小苏推荐使用“树莓派爱好者基地”编译的 64 位 Debian，此版本 Debian 可以充分发挥 64 位 CPU 的性能，同时默认开启 Docker，KVM 等功能，其中，Docker 功能开箱即用，非常方便。</p>
<p>如果你的设备是树莓派2B，那么你可能需要在其他发行版上手动安装 Docker 了，但是小苏提供的 Docker 镜像是支持 2B~4B 设备的，换句话说，只要在其他发行版上成功安装了 Docker，也是可以用我提供的 OpenWrt 镜像的。</p>
<p>为了方便叙述以及为大家提供一个参考的宿主机环境，下文内容基于“树莓派爱好者基地”编译的 64 位 Debian。当然，如果你在你使用的发行版上安装了 Docker，步骤是一样的。</p>
<p>“树莓派爱好者基地”专版64位 Debian 功能介绍：</p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/F-_hQIVlsAlA-tLPWEYeUw">https://mp.weixin.qq.com/s/F-_hQIVlsAlA-tLPWEYeUw</a></p>
<p>下载：</p>
<p><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1czBi6isWh0qavXC72nT5fw">https://pan.baidu.com/s/1czBi6isWh0qavXC72nT5fw</a></p>
<p>下载时推荐选择“无桌面基础系统加强版”（如下图），如果你有图形界面需求，也可以选择带图形界面的其他版本镜像。</p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570362720094.png" alt="建议选择“无桌面基础系统加强版”"></p>
<p>下载镜像烧写到树莓派的 SD 卡并上电开机后，系统会自动完成扩展 SD 卡空间的操作，这个过程大约需要3~5分钟（期间会重启几次）。估摸着时间差不多以后，用网线将树莓派的板载网口与路由器的 Lan 口连接，之后连接树莓派的 SSH：</p>
<p>用户名：<code>pi</code></p>
<p>密码：<code>raspberry</code></p>
<p>准备工作到此结束。</p>
<h2 id="步骤开始"><a href="#步骤开始" class="headerlink" title="步骤开始"></a>步骤开始</h2><p>成功登陆到树莓派的 SSH 后，在拉取镜像之前，我们还需要进行一些额外的工作：</p>
<h3 id="1-打开网卡混杂模式"><a href="#1-打开网卡混杂模式" class="headerlink" title="1.打开网卡混杂模式"></a>1.打开网卡混杂模式</h3><blockquote>
<p>sudo ip link set eth0 promisc on </p>
</blockquote>
<h3 id="2-创建网络"><a href="#2-创建网络" class="headerlink" title="2.创建网络"></a>2.创建网络</h3><p><strong>(须结合实际网络情况，不能照抄命令)</strong></p>
<blockquote>
<p>docker network create -d macvlan –subnet=192.168.123.0/24 –gateway=192.168.123.1 -o parent=eth0 macnet</p>
</blockquote>
<p>这一条命令需要根据树莓派所处的网络环境来做修改，可以使用 <code>sudo ifconfig</code>命令来查看树莓派 eth0 网卡获得的 IP 地址，如果树莓派获得的 IP 地址为 <code>192.168.2.154</code>，那么说明树莓派处在 <code>192.168.2.x</code>网段，相应的，命令中的<code>192.168.123.0</code>和<code>192.168.123.1</code>需要被替换成 <code>192.168.2.0</code>和<code>192.168.2.1</code>：</p>
<blockquote>
<p>docker network create -d macvlan –subnet=192.168.0.0/24 –gateway=192.168.0.1 -o parent=eth0 macnet</p>
</blockquote>
<p>此时，我们使用 <code>docker network ls</code>命令可以看到网络<code>macnet</code>已建立成功：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ docker network ls</span><br><span class="line">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class="line">10e676133746        bridge              bridge              local</span><br><span class="line">f5308b94e8fa        host                host                local</span><br><span class="line">16745ea66852        macnet              macvlan             local</span><br><span class="line">5e72e41ea02a        none                null                local</span><br></pre></td></tr></table></figure>
<h3 id="3-拉取镜像"><a href="#3-拉取镜像" class="headerlink" title="3.拉取镜像"></a>3.拉取镜像</h3><p>若身处国内，为提高拉取速度，请拉取阿里云仓库中的镜像：</p>
<blockquote>
<p>docker pull registry.cn-shanghai.aliyuncs.com/suling/openwrt:latest</p>
</blockquote>
<p>同时小苏也提供存放在 <a target="_blank" rel="noopener" href="https://hub.docker.com/r/sulinggg/openwrt">Docker 官方仓库</a> 中的镜像：</p>
<blockquote>
<p>docker pull sulinggg/openwrt:latest</p>
</blockquote>
<p>镜像拉取完成后，我们可以执行<code>docker images</code>命令查看现存镜像：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker images</span><br><span class="line">REPOSITORY                                              TAG                 IMAGE ID            CREATED             SIZE</span><br><span class="line">registry.cn-shanghai.aliyuncs.com&#x2F;suling&#x2F;openwrt        latest              4f4bc5dca2d9        3 hours ago         112MB</span><br></pre></td></tr></table></figure>
<p>可见，镜像已成功拉取到本地。</p>
<h3 id="4-创建并启动容器"><a href="#4-创建并启动容器" class="headerlink" title="4.创建并启动容器"></a>4.创建并启动容器</h3><blockquote>
<p>docker run –restart always –name openwrt -d –network macnet –privileged registry.cn-shanghai.aliyuncs.com/suling/openwrt:latest /sbin/init</p>
</blockquote>
<p>其中：</p>
<p><code>--restart always</code>参数表示容器退出时始终重启，使服务尽量保持始终可用；</p>
<p><code>--name openwrt</code>参数定义了容器的名称；</p>
<p><code>-d</code>参数定义使容器运行在 Daemon 模式；</p>
<p><code>--network macnet</code>参数定义将容器加入 <code>maxnet</code>网络；</p>
<p><code>--privileged </code>参数定义容器运行在特权模式下；</p>
<p><code>registry.cn-shanghai.aliyuncs.com/suling/openwrt:latest</code>为 Docker 镜像名，因容器托管在阿里云 Docker 镜像仓库内，所以在镜像名中含有阿里云仓库信息；</p>
<p><code>/sbin/init</code>定义容器启动后执行的命令。</p>
<p>启动容器后，我们可以使用 <code>docker ps -a</code>命令查看当前运行的容器：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ docker ps -a</span><br><span class="line">CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</span><br><span class="line">a26cee7cade6        openwrt:latest      &quot;&#x2F;sbin&#x2F;init&quot;        3 hours ago         Up 3 hours                              openwrt</span><br></pre></td></tr></table></figure>
<p>若容器运行信息<code>STATUS</code>列为 <code>UP</code>状态，则说明容器运行正常。</p>
<h3 id="5-进入容器并修改相关参数"><a href="#5-进入容器并修改相关参数" class="headerlink" title="5.进入容器并修改相关参数"></a>5.进入容器并修改相关参数</h3><p><strong>(须结合实际网络情况，不能照抄配置)</strong></p>
<blockquote>
<p>docker exec -it openwrt bash</p>
</blockquote>
<p>其中：</p>
<p><code>openwrt</code>为容器名称；</p>
<p><code>bash</code>为进入容器后执行的命令。</p>
<p>执行此命令后我们便进入  OpenWrt 的命令行界面，首先，我们需要编辑 OpenWrt 的网络配置文件：</p>
<blockquote>
<p>vim /etc/config/network</p>
</blockquote>
<p>我们需要更改 Lan 口设置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">config interface &#39;lan&#39;</span><br><span class="line">        option type &#39;bridge&#39;</span><br><span class="line">        option ifname &#39;eth0&#39;</span><br><span class="line">        option proto &#39;static&#39;</span><br><span class="line">        option ipaddr &#39;192.168.123.100&#39;</span><br><span class="line">        option netmask &#39;255.255.255.0&#39;</span><br><span class="line">        option ip6assign &#39;60&#39;</span><br><span class="line">        option gateway &#39;192.168.123.1&#39;</span><br><span class="line">        option broadcast &#39;192.168.123.255&#39;</span><br><span class="line">        option dns &#39;192.168.123.1&#39;</span><br></pre></td></tr></table></figure>
<p>其中：</p>
<p>所有的 <code>192.168.123.x</code> 需要根据树莓派所处网段修改，<code>option gateway</code>和<code>option dns</code>填写路由器的 IP，若树莓派获得的 IP 为 <code>192.168.2.154</code>，路由器 IP 为<code>192.168.2.1</code>，则需要这样修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">config interface &#39;lan&#39;</span><br><span class="line">        option type &#39;bridge&#39;</span><br><span class="line">        option ifname &#39;eth0&#39;</span><br><span class="line">        option proto &#39;static&#39;</span><br><span class="line">        option ipaddr &#39;192.168.2.100&#39;</span><br><span class="line">        option netmask &#39;255.255.255.0&#39;</span><br><span class="line">        option ip6assign &#39;60&#39;</span><br><span class="line">        option gateway &#39;192.168.2.1&#39;</span><br><span class="line">        option broadcast &#39;192.168.2.255&#39;</span><br><span class="line">        option dns &#39;192.168.2.1&#39;</span><br></pre></td></tr></table></figure>
<p><code>option ipaddr </code>项目定义了  OpenWrt 的 IP 地址，在完成网段设置后，IP最后一段可根据自己的爱好修改（前提是符合规则且不和现有已分配 IP 冲突）。</p>
<h3 id="6-重启网络"><a href="#6-重启网络" class="headerlink" title="6.重启网络"></a>6.重启网络</h3><blockquote>
<p>/etc/init.d/network restart</p>
</blockquote>
<h3 id="7-进入控制面板"><a href="#7-进入控制面板" class="headerlink" title="7.进入控制面板"></a>7.进入控制面板</h3><p>在浏览器中输入第 5 步<code>option ipaddr </code>项目中的 IP 进入 Luci 控制面板，若<code>option ipaddr </code>的参数为 <code>192.168.123.100</code>，则可以在浏览器输入 <code>http://192.168.0.100</code>进入控制面板。</p>
<p>用户名：<code>root</code></p>
<p>密码：<code>password</code></p>
<h3 id="8-关闭-DHCP-服务"><a href="#8-关闭-DHCP-服务" class="headerlink" title="8.关闭 DHCP 服务"></a>8.关闭 DHCP 服务</h3><p>在 “网络 - 接口 - Lan - 修改” 界面中，勾选下方的 “<strong>忽略此接口（不在此接口提供 DHCP 服务）</strong>”，并“<strong>保存&amp;应用</strong>”。</p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570370001979.png" alt="关闭 “DHCP 服务”"></p>
<h3 id="9-主路由-DHCP-设置"><a href="#9-主路由-DHCP-设置" class="headerlink" title="9.主路由 DHCP 设置"></a>9.主路由 DHCP 设置</h3><p>进入路由器后台中，将主路由的 DHCP 的默认网关和 DNS 服务器设置为第 5 步中<code>option ipaddr </code>项目中的 IP。</p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570370097838.png" alt="主路由 DHCP 设置"></p>
<h3 id="10-重新连接路由器"><a href="#10-重新连接路由器" class="headerlink" title="10.重新连接路由器"></a>10.重新连接路由器</h3><p>完成以上操作后，断开设备（如手机，电脑）与路由器的连接，重新连接路由器，连接路由器的设备将获取到我们设置到的 IP。</p>
<h2 id="其他修复"><a href="#其他修复" class="headerlink" title="其他修复"></a>其他修复</h2><h3 id="1-关闭-WLAN-硬件加速"><a href="#1-关闭-WLAN-硬件加速" class="headerlink" title="1.关闭 WLAN 硬件加速"></a>1.关闭 WLAN 硬件加速</h3><p>设置旁路路由后，若出现访问国内网站网速慢，不稳定的情况（多见于 Pandavan 及其改版固件，如华硕老毛子固件），请在路由器的控制面板中关闭有关 WLAN 的硬件加速，比如选择“Offload TCP/UDP for LAN”（若未出现此现象请忽略）：</p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570370909461.png" alt="关闭 WLAN 硬件加速"></p>
<h3 id="2-宿主机网络修复"><a href="#2-宿主机网络修复" class="headerlink" title="2.宿主机网络修复"></a>2.宿主机网络修复</h3><p>OpenWrt 容器运行后，宿主机内可能无法正常连接外部网络，需要修改宿主机的 <code>/etc/network/interfaces</code> 文件以修复：</p>
<p><strong>(须结合实际网络情况，不能照抄配置)</strong></p>
<blockquote>
<p>cp /etc/network/interfaces /etc/network/interfaces.bak # 备份文件</p>
</blockquote>
<blockquote>
<p>vim /etc/network/interfaces # 使用 vim 编辑文件</p>
</blockquote>
<p>以“树莓派爱好者基地”64 位 Debian 为例，向文件末尾添加：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">auto eth0</span><br><span class="line">iface eth0 inet manual</span><br><span class="line"></span><br><span class="line">auto macvlan</span><br><span class="line">iface macvlan inet static</span><br><span class="line">  address 192.168.123.200</span><br><span class="line">  netmask 255.255.255.0</span><br><span class="line">  gateway 192.168.123.1</span><br><span class="line">  dns-nameservers 192.168.123.1</span><br><span class="line">  pre-up ip link add macvlan link eth0 type macvlan mode bridge</span><br><span class="line">  post-down ip link del macvlan link eth0 type macvlan mode bridge</span><br></pre></td></tr></table></figure>
<p>其中，所有的 <code>192.168.123.x</code>都需要按照树莓派所处网段更改，<code>gateway</code>和<code>dns-nameservers</code>填写路由器的 IP，若树莓派获得的 IP 为 <code>192.168.2.154</code>，路由器 IP 为<code>192.168.2.1</code>，则需要这样修改：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">auto eth0</span><br><span class="line">iface eth0 inet manual</span><br><span class="line"></span><br><span class="line">auto macvlan</span><br><span class="line">iface macvlan inet static</span><br><span class="line">  address 192.168.2.200</span><br><span class="line">  netmask 255.255.255.0</span><br><span class="line">  gateway 192.168.2.1</span><br><span class="line">  dns-nameservers 192.168.2.1</span><br><span class="line">  pre-up ip link add macvlan link eth0 type macvlan mode bridge</span><br><span class="line">  post-down ip link del macvlan link eth0 type macvlan mode bridge</span><br></pre></td></tr></table></figure>
<p>修改后重启树莓派，之后树莓派的局域网 IP 地址将会固定为<code>/etc/network/interfaces</code>文件中<code>address</code>参数中的地址。</p>
<h3 id="3-手动指定网关"><a href="#3-手动指定网关" class="headerlink" title="3.手动指定网关"></a>3.手动指定网关</h3><p>如果路由器固件不支持自定义 DHCP 服务的网关及 DNS 地址（常见于路由器官方固件），或者只希望局域网下的个别设备接入旁路网关时，须在接入设备上做以下配置：</p>
<h4 id="安卓："><a href="#安卓：" class="headerlink" title="安卓："></a>安卓：</h4><p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570424885014.png" alt="安卓设置"></p>
<p>需要在安卓的 WIFI 设置内将 IP 获取方式更改为“静态”或“手动”，其中：</p>
<p>“IP 地址”项目需要更改为网段内不冲突的地址；</p>
<p>“网关”或“路由器”项目需要更改为旁路网关 IP 地址；</p>
<p>“前缀长度”项目填写“24”；</p>
<p>“DNS”项目需要更改为旁路网关 IP 地址（两个 DNS 输入框填写一个就可以）。</p>
<p>完成并提交设置后，关闭 WIFI 开关再打开，连接设置的 WIFI 热点，若当前网络参数为设定值，则证明设置成功。</p>
<h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows:"></a>Windows:</h4><p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570425536078.png" alt="Windows 设置"></p>
<p>在无线热点的“属性”界面下，点击 “IP 设置 - 编辑”按钮，在弹出框中更改 IP 分配模式为“手动”，打开 IPV4 的开关，根据所处网段及上文安卓的相关设置填写相关参数即可。</p>
<h2 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h2><ol>
<li><p><strong>文章所述方案适用于光猫或路由器已完成宽带拨号的网络环境，未测试也不推荐使用 Docker 内的 OpenWrt 进行宽带拨号</strong>；</p>
</li>
<li><p>OpenWrt 容器跟随树莓派系统启动，无需手动干预；</p>
</li>
<li><p>由于容器内系统内核共享宿主机内核，所以在 Luci 面板的 “内核版本”项与宿主机内核版本一致；</p>
</li>
<li><p>在对容器进行停止或删除操作时，树莓派可能会发生卡顿现象，SSH 可能会断开，1~2 分钟后会恢复正常，目前原因不明；</p>
</li>
<li><p>经测试，发现 Adblock 不工作，UnblockNeteaseMusic 需要自行设置代理，除此之外容器中的 OpenWrt 多数应用工作正常，如有发现不能正常工作的应用请评论反馈~</p>
</li>
</ol>
<h2 id="功能展示"><a href="#功能展示" class="headerlink" title="功能展示"></a>功能展示</h2><p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427399298.png" alt="总览面板"></p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427504837.png" alt="系统设置"></p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427438125.png" alt="ShadowSocksR Plus+"></p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427538310.png" alt="Aria2"></p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427568808.png" alt="OPENVPN服务器"></p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427605996.png" alt="接口设置"></p>
<p><img src="https://file.mlapp.cn/usr/uploads/2019/10/1570427653385.png" alt="带宽监控"></p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">34hz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://www.34hz.top/2020/12/29/%E6%A0%91%E8%8E%93%E6%B4%BE64%E4%BD%8DDocker%E8%BF%90%E8%A1%8COpenWrt/">http://www.34hz.top/2020/12/29/树莓派64位Docker运行OpenWrt/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://www.34hz.top" target="_blank">34Hz</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%99%E7%A8%8B/">教程</a><a class="post-meta__tags" href="/tags/%E5%B7%A5%E5%85%B7/">工具</a><a class="post-meta__tags" href="/tags/%E9%85%8D%E7%BD%AE/">配置</a><a class="post-meta__tags" href="/tags/linux/">linux</a><a class="post-meta__tags" href="/tags/%E8%BD%AF%E8%B7%AF%E7%94%B1/">软路由</a></div><div class="post_share"><div class="social-share" data-image="https://tva3.sinaimg.cn/large/0076tTSdgy1gm55f69axxj30d603n3yi.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/12/29/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%90%AD%E5%BB%BAKod/"><img class="next-cover" src="https://tva1.sinaimg.cn/large/0076tTSdgy1gm4joc77abj30p00hvnjw.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">树莓派搭建Kod</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/12/27/ubuntu安装手册/" title="ubuntu安装手册"><img class="cover" src="https://tvax1.sinaimg.cn/large/0076tTSdgy1gm4jvlzo8uj30ia0cxq38.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-27</div><div class="title">ubuntu安装手册</div></div></a></div><div><a href="/2020/12/29/vimrc配置文档/" title="vimrc配置文档"><img class="cover" src="/img/vimico.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-29</div><div class="title">vimrc配置文档</div></div></a></div><div><a href="/2020/12/29/树莓派搭建Kod/" title="树莓派搭建Kod"><img class="cover" src="https://tva1.sinaimg.cn/large/0076tTSdgy1gm4joc77abj30p00hvnjw.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-29</div><div class="title">树莓派搭建Kod</div></div></a></div><div><a href="/2020/12/27/WindowsTerminal美化配置文件/" title="WindowsTerminal美化配置文件"><img class="cover" src="https://tva4.sinaimg.cn/large/0076tTSdgy1gm2i2s8vq8j312v0m0jux.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-27</div><div class="title">WindowsTerminal美化配置文件</div></div></a></div><div><a href="/2020/12/26/useBaota/" title="宝塔面板使用命令"><img class="cover" src="https://img.vpsss.net/wp-content/uploads/2019/12/btmbbanner-1.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-26</div><div class="title">宝塔面板使用命令</div></div></a></div></div></div></div><div class="aside_content" id="aside_content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="card-content"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF1"><span class="toc-number">1.</span> <span class="toc-text">场景1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF2"><span class="toc-number">2.</span> <span class="toc-text">场景2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%81%E8%B7%AF%E7%BD%91%E5%85%B3"><span class="toc-number">3.</span> <span class="toc-text">旁路网关</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E8%A6%81%E8%AF%B4%E6%98%8E"><span class="toc-number"></span> <span class="toc-text">重要说明</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87"><span class="toc-number"></span> <span class="toc-text">前期准备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A5%E9%AA%A4%E5%BC%80%E5%A7%8B"><span class="toc-number"></span> <span class="toc-text">步骤开始</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%89%93%E5%BC%80%E7%BD%91%E5%8D%A1%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.</span> <span class="toc-text">1.打开网卡混杂模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E7%BD%91%E7%BB%9C"><span class="toc-number">2.</span> <span class="toc-text">2.创建网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8B%89%E5%8F%96%E9%95%9C%E5%83%8F"><span class="toc-number">3.</span> <span class="toc-text">3.拉取镜像</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E5%B9%B6%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"><span class="toc-number">4.</span> <span class="toc-text">4.创建并启动容器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8%E5%B9%B6%E4%BF%AE%E6%94%B9%E7%9B%B8%E5%85%B3%E5%8F%82%E6%95%B0"><span class="toc-number">5.</span> <span class="toc-text">5.进入容器并修改相关参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E9%87%8D%E5%90%AF%E7%BD%91%E7%BB%9C"><span class="toc-number">6.</span> <span class="toc-text">6.重启网络</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E8%BF%9B%E5%85%A5%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF"><span class="toc-number">7.</span> <span class="toc-text">7.进入控制面板</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E5%85%B3%E9%97%AD-DHCP-%E6%9C%8D%E5%8A%A1"><span class="toc-number">8.</span> <span class="toc-text">8.关闭 DHCP 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E4%B8%BB%E8%B7%AF%E7%94%B1-DHCP-%E8%AE%BE%E7%BD%AE"><span class="toc-number">9.</span> <span class="toc-text">9.主路由 DHCP 设置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-%E9%87%8D%E6%96%B0%E8%BF%9E%E6%8E%A5%E8%B7%AF%E7%94%B1%E5%99%A8"><span class="toc-number">10.</span> <span class="toc-text">10.重新连接路由器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E4%BF%AE%E5%A4%8D"><span class="toc-number"></span> <span class="toc-text">其他修复</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%85%B3%E9%97%AD-WLAN-%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F"><span class="toc-number">1.</span> <span class="toc-text">1.关闭 WLAN 硬件加速</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%BF%E4%B8%BB%E6%9C%BA%E7%BD%91%E7%BB%9C%E4%BF%AE%E5%A4%8D"><span class="toc-number">2.</span> <span class="toc-text">2.宿主机网络修复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%89%8B%E5%8A%A8%E6%8C%87%E5%AE%9A%E7%BD%91%E5%85%B3"><span class="toc-number">3.</span> <span class="toc-text">3.手动指定网关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E5%8D%93%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">安卓：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Windows"><span class="toc-number">3.2.</span> <span class="toc-text">Windows:</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number"></span> <span class="toc-text">注意事项</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8A%9F%E8%83%BD%E5%B1%95%E7%A4%BA"><span class="toc-number"></span> <span class="toc-text">功能展示</span></a></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 By 34hz</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="translateLink" type="button" title="简繁转换">簡</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><div class="js-pjax"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sviptzk/HexoStaticFile@latest/Hexo/js/mouse_snow.min.js"></script><script src="/js/mirror.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="70" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-nest.min.js"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-show-text.min.js" data-mobile="false" data-text="小  刘,小  王,十  一" data-fontsize="15px" data-random="true" async="async"></script><div class="GalMenu GalDropDown"><div class="circle" id="gal"><div class="ring"><a class="menuItem" href="/"><span>首页</span></a><a class="menuItem" href="/comments/"><span>留言板</span></a><a class="menuItem" href="/tags/"><span>标签</span></a><a class="menuItem" href="javascript:void(0);" onclick="Mirror()"><span>Gitee镜像站</span></a><a class="menuItem" href="/link/"><span>友人帐</span></a><a class="menuItem" href="/archives/"><span>时间轴</span></a><a class="menuItem" href="javascript:void(0);" onclick="Mirror2()"><span>刷新</span></a></div></div><audio id="audio" src="https://cdn.jsdelivr.net/gh/Akilarlxh/Akilarlxh.github.io@v3.3.3_3/galmenu/galmenu.mp3"></audio></div><script defer="defer" src="https://cdn.jsdelivr.net/gh/Akilarlxh/Akilarlxh.github.io@bf_3.3.0_12/js/custom/galmenu.min.js"></script></div></body></html>